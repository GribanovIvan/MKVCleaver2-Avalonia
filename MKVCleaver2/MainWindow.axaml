<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="using:MKVCleaver2"
        x:Class="MKVCleaver2.MainWindow"
        Title="MKVCleaver2" 
        Width="800" Height="600" 
        MinWidth="600" MinHeight="400"
        WindowStartupLocation="CenterScreen">
    <DockPanel Margin="10">
        <!-- Top panel with buttons -->
        <StackPanel DockPanel.Dock="Top" Orientation="Horizontal" Margin="0,0,0,10">
            <Button x:Name="btnAddFile" Content="Open MKV files..." 
                    Margin="0,0,10,0" Click="btnAddFile_Click"/>
            <Button x:Name="btnLocateToolnix" Content="Locate MKVToolnix..." 
                    Margin="0,0,10,0" Click="btnLocateToolnix_Click"/>
            <Button x:Name="btnAbout" Content="About" 
                    HorizontalAlignment="Right"/>
        </StackPanel>
        
        <!-- Main content area -->
        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="2*"/>
                <ColumnDefinition Width="10"/>
                <ColumnDefinition Width="1*"/>
            </Grid.ColumnDefinitions>
            <Grid.RowDefinitions>
                <RowDefinition Height="*"/>
                <RowDefinition Height="10"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="10"/>
                <RowDefinition Height="Auto"/>
            </Grid.RowDefinitions>
            
            <!-- Files section -->
            <Border x:Name="filesBorder" 
                    BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="2" 
                    Background="{DynamicResource SystemChromeLowColor}"
                    CornerRadius="5">
                <DockPanel Margin="10">
                    <TextBlock DockPanel.Dock="Top" 
                               Text="Files to process (drag MKV files here)" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10"/>
                    
                    <StackPanel DockPanel.Dock="Bottom" 
                                Orientation="Horizontal" 
                                Margin="0,10,0,0">
                        <Button x:Name="btnRemoveFile" 
                                Content="Remove selected" 
                                IsEnabled="False" 
                                Click="btnRemoveFile_Click"/>
                    </StackPanel>
                    
                    <TreeView x:Name="tvFiles" 
                              Background="Transparent">
                        <TreeView.DataTemplates>
                            <TreeDataTemplate DataType="local:MkvFile" ItemsSource="{Binding Tracks}">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                                    <TextBlock Text=" " />
                                    <TextBlock Text="{Binding Name}"/>
                                </StackPanel>
                            </TreeDataTemplate>
                            <DataTemplate DataType="local:Track">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                                    <TextBlock Text=" " />
                                    <TextBlock Text="{Binding Type}" />
                                    <TextBlock Text=": " />
                                    <TextBlock Text="{Binding Name}" />
                                    <TextBlock Text=" (" />
                                    <TextBlock Text="{Binding Codec}" />
                                    <TextBlock Text=")" />
                                </StackPanel>
                            </DataTemplate>
                        </TreeView.DataTemplates>
                    </TreeView>
                </DockPanel>
            </Border>
            
            <!-- Batch tracks section -->
            <Border Grid.Column="2" 
                    BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="1" 
                    CornerRadius="5">
                <DockPanel Margin="10">
                    <TextBlock DockPanel.Dock="Top" 
                               Text="Tracks to extract (Batch Mode)" 
                               FontWeight="Bold" 
                               Margin="0,0,0,10"/>
                    
                    <ListBox x:Name="lbBatchTracksToExtract">
                        <ListBox.DataTemplates>
                            <DataTemplate DataType="local:BatchTrack">
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding IsSelected, Mode=TwoWay}"/>
                                    <TextBlock Text=" " />
                                    <TextBlock Text="{Binding Name}" />
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.DataTemplates>
                    </ListBox>
                </DockPanel>
            </Border>
            
            <!-- Filename options -->
            <Border Grid.Row="2" 
                    BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="1" 
                    CornerRadius="5">
                <StackPanel Margin="10">
                    <TextBlock Text="Filename options" FontWeight="Bold" Margin="0,0,0,10"/>
                    <StackPanel>
                        <RadioButton x:Name="rbtnTrackFilename" 
                                     Content="Track#__&lt;filename&gt;" 
                                     IsEnabled="False"/>
                        <RadioButton x:Name="rbtFilenameTrack" 
                                     Content="&lt;filename&gt;__Track#" 
                                     IsChecked="True" 
                                     IsEnabled="False"/>
                    </StackPanel>
                    <CheckBox x:Name="cbUseTrackTypeName" 
                              Content="Use 'Audio', 'Video' and 'Subtitle'" 
                              Margin="0,10,0,0" 
                              IsEnabled="False"/>
                    <Button x:Name="btnCustomFilename" 
                            Content="Custom..." 
                            HorizontalAlignment="Right" 
                            Margin="0,10,0,0" 
                            IsEnabled="False"/>
                </StackPanel>
            </Border>
            
            <!-- Output directory -->
            <Border Grid.Row="2" Grid.Column="2" 
                    BorderBrush="{DynamicResource SystemAccentColor}" 
                    BorderThickness="1" 
                    CornerRadius="5">
                <StackPanel Margin="10">
                    <TextBlock Text="Output directory" FontWeight="Bold" Margin="0,0,0,10"/>
                    <TextBlock Text="(leave blank for original directory)" 
                               FontSize="11" 
                               Foreground="{DynamicResource SystemBaseMediumColor}" 
                               Margin="0,0,0,5"/>
                    <Grid>
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="Auto"/>
                        </Grid.ColumnDefinitions>
                        <TextBox x:Name="tboutputDir" 
                                 Margin="0,0,5,0" 
                                 IsEnabled="False"/>
                        <Button x:Name="btnSetOutputDir" 
                                Grid.Column="1" 
                                Content="..." 
                                Width="30" 
                                IsEnabled="False"/>
                    </Grid>
                </StackPanel>
            </Border>
            
            <!-- Extract button and progress -->
            <StackPanel Grid.Row="4" Grid.ColumnSpan="3">
                <Button x:Name="btnExtract" 
                        Content="Extract Tracks!" 
                        HorizontalAlignment="Center" 
                        Padding="20,10" 
                        FontWeight="Bold" 
                        IsEnabled="False" 
                        Click="btnExtract_Click"/>
                
                <Grid Margin="0,10,0,0">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition/>
                        <ColumnDefinition Width="10"/>
                        <ColumnDefinition/>
                    </Grid.ColumnDefinitions>
                    <StackPanel>
                        <TextBlock Text="Current file progress:" FontSize="11"/>
                        <ProgressBar x:Name="pbCurrentFile" Height="20"/>
                    </StackPanel>
                    <StackPanel Grid.Column="2">
                        <TextBlock Text="Total progress:" FontSize="11"/>
                        <ProgressBar x:Name="pbTotalProgress" Height="20"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Grid>
    </DockPanel>
</Window>